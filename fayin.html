<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ çº¯å¬éŸ³é€‰æ±‰å­—</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background-color: #f0f9f0;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        h1 {
            color: #2d5a2d;
            font-size: 36px;
            margin-bottom: 10px;
        }
        .speak-btn {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 80px;
            height: 80px;
            font-size: 30px;
            cursor: pointer;
            margin: 20px auto;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }
        .speak-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 500px;
            margin: 20px auto;
        }
        .option {
            background: white;
            border: 3px solid #ddd;
            border-radius: 15px;
            font-size: 40px;
            padding: 25px 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option:hover {
            border-color: #4CAF50;
            background: #f0fff0;
        }
        .option.correct {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        .option.wrong {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        .progress {
            font-size: 20px;
            margin: 15px 0;
            color: #2d5a2d;
        }
        .success-message {
            font-size: 28px;
            color: #2d5a2d;
            margin: 30px 0;
            display: none;
        }
        .restart-btn {
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 24px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
        }
        /* æ–°å¢æ ·å¼ï¼šå¼€å…³ */
        .toggle-container {
            margin: 10px auto;
            font-size: 18px;
            color: #2d5a2d;
        }
        .toggle-container input {
            margin-right: 8px;
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <h1>ğŸ§ çº¯å¬éŸ³é€‰æ±‰å­—</h1>
    <div class="progress" id="progress">ç¬¬1é¢˜ / å…±8é¢˜</div>
    <button class="speak-btn" id="speakBtn">ğŸ”Š</button>
    <!-- æ–°å¢ï¼šå¼€å…³å®¹å™¨ -->
    <div class="toggle-container">
        <input type="checkbox" id="includeMeaning" checked>
        <label for="includeMeaning">åŒ…æ‹¬å«ä¹‰è§£é‡Š</label>
    </div>
    <div class="options" id="options"></div>
    <div class="success-message" id="successMessage">
        ğŸ‰ æŒ‘æˆ˜æˆåŠŸï¼ ğŸ‰<br>
        <span id="errorCountDisplay"></span><br>
        <button class="restart-btn" onclick="restartGame()">å†ç©ä¸€æ¬¡</button>
    </div>

    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>

    <script>
        // ç”Ÿå­—æ•°æ®ï¼ˆæ·»åŠ äº†meaningå­—æ®µï¼‰
        const gameData = [
            {char: 'ä¸Šä¸‹', pinyin: 'shÃ ng xiÃ ', meaning: 'è¡¨ç¤ºå‚ç›´æ–¹å‘çš„ä½ç½®ã€‚'},
            {char: 'å·¦å³', pinyin: 'zuÇ’ yÃ²u', meaning: 'è¡¨ç¤ºæ°´å¹³æ–¹å‘çš„ä½ç½®ã€‚'},
            {char: 'å‰å', pinyin: 'qiÃ¡n hÃ²u', meaning: 'è¡¨ç¤ºå‰åé¡ºåºçš„ä½ç½®ã€‚'},
            {char: 'å¤šå°‘', pinyin: 'duÅ shÇo', meaning: 'è¯¢é—®æ•°é‡çš„å¤šå°‘ã€‚'},
            {char: 'å“ªäº›', pinyin: 'nÇ xiÄ“', meaning: 'è¯¢é—®å…·ä½“çš„äº‹ç‰©ã€‚'},
            {char: 'æŒ‰ç…§', pinyin: 'Ã n zhÃ o', meaning: 'æ ¹æ®æŸç§è§„åˆ™æˆ–æ–¹å¼ã€‚'},
            {char: 'æ–¹æ³•', pinyin: 'fÄng fÇ', meaning: 'è§£å†³é—®é¢˜çš„æ–¹å¼ã€‚'},
            {char: 'ç›¸åŒ', pinyin: 'xiÄng tÃ³ng', meaning: 'ä¸€æ ·ï¼Œæ²¡æœ‰åŒºåˆ«ã€‚'},
            {char: 'ä¸åŒ', pinyin: 'bÃ¹ tÃ³ng', meaning: 'ä¸ä¸€æ ·ï¼Œæœ‰åŒºåˆ«ã€‚'},
            {char: 'é«˜çŸ®', pinyin: 'gÄo Çi', meaning: 'æè¿°é«˜åº¦çš„å¯¹æ¯”ã€‚'},
            {char: 'é•¿çŸ­', pinyin: 'chÃ¡ng duÇn', meaning: 'æè¿°é•¿åº¦çš„å¯¹æ¯”ã€‚'},
            {char: 'è¡¨ç¤º', pinyin: 'biÇo shÃ¬', meaning: 'è¡¨è¾¾æŸç§æ„æ€ã€‚'},
            {char: 'åœˆä¸€åœˆ', pinyin: 'quÄn yÄ« quÄn', meaning: 'ç”¨åœˆæ ‡è®°å‡ºæ¥ã€‚'},
            {char: 'ç”»ä¸€ç”»', pinyin: 'huÃ  yÄ« huÃ ', meaning: 'ç»˜åˆ¶ä¸€ä¸‹ã€‚'},
            {char: 'æ•°ä¸€æ•°', pinyin: 'shÇ” yÄ« shÇ”', meaning: 'è®¡ç®—æ•°é‡ã€‚'},
            {char: 'è¿ä¸€è¿', pinyin: 'liÃ¡n yÄ« liÃ¡n', meaning: 'ç”¨çº¿è¿æ¥èµ·æ¥ã€‚'},
            {char: 'æ¶‚ä¸€æ¶‚', pinyin: 'tÃº yÄ« tÃº', meaning: 'æ¶‚ä¸Šé¢œè‰²ã€‚'},
            {char: 'æ¯”ä¸€æ¯”', pinyin: 'bÇ yÄ« bÇ', meaning: 'è¿›è¡Œæ¯”è¾ƒã€‚'},
            {char: 'çƒ', pinyin: 'qiÃº', meaning: 'åœ†å½¢çš„ç‰©ä½“ã€‚'},
            {char: 'æ­£æ–¹ä½“', pinyin: 'zhÃ¨ng fÄng tÇ', meaning: 'å…­ä¸ªé¢éƒ½æ˜¯æ­£æ–¹å½¢çš„ç«‹ä½“ã€‚'},
            {char: 'é•¿æ–¹ä½“', pinyin: 'chÃ¡ng fÄng tÇ', meaning: 'å…­ä¸ªé¢éƒ½æ˜¯çŸ©å½¢çš„ç«‹ä½“ã€‚'},
            {char: 'æ­£æ–¹å½¢', pinyin: 'zhÃ¨ng fÄng xÃ­ng', meaning: 'å››ä¸ªè¾¹ç›¸ç­‰çš„å¹³é¢å›¾å½¢ã€‚'},
            {char: 'é•¿æ–¹å½¢', pinyin: 'chÃ¡ng fÄng xÃ­ng', meaning: 'å¯¹è¾¹ç›¸ç­‰çš„çŸ©å½¢å¹³é¢å›¾å½¢ã€‚'},
            {char: 'åœ†æŸ±', pinyin: 'yuÃ¡n zhÃ¹', meaning: 'åœ†å½¢åº•é¢çš„æŸ±çŠ¶ç«‹ä½“ã€‚'},
            {char: 'åŸæ¥', pinyin: 'yuÃ¡n lÃ¡i', meaning: 'è¡¨ç¤ºæœ€åˆçš„æƒ…å†µã€‚'},
            {char: 'ç°åœ¨', pinyin: 'xiÃ n zÃ i', meaning: 'è¡¨ç¤ºå½“å‰çš„æ—¶é—´ã€‚'},
            {char: 'ä¸€å…±', pinyin: 'yÄ« gÃ²ng', meaning: 'æ€»è®¡çš„æ•°é‡ã€‚'},
            {char: 'è¿˜æœ‰', pinyin: 'hÃ¡i yÇ’u', meaning: 'è¡¨ç¤ºå‰©ä½™æˆ–é¢å¤–ã€‚'},
            {char: 'å‰©ä¸‹', pinyin: 'shÃ¨ng xiÃ ', meaning: 'å‰©ä½™çš„éƒ¨åˆ†ã€‚'},
            {char: 'åˆèµ·æ¥', pinyin: 'hÃ© qÇ lÃ¡i', meaning: 'åˆå¹¶åœ¨ä¸€èµ·ã€‚'},
            {char: 'çœ‹å›¾', pinyin: 'kÃ n tÃº', meaning: 'è§‚å¯Ÿå›¾ç‰‡ã€‚'},
            {char: 'æˆ–è€…', pinyin: 'huÃ² zhÄ›', meaning: 'è¡¨ç¤ºé€‰æ‹©ä¹‹ä¸€ã€‚'},
            {char: 'åªæœ‰', pinyin: 'zhÇ yÇ’u', meaning: 'ä»…ä»…æœ‰ã€‚'},
            {char: 'é€‰æ‹©', pinyin: 'xuÇn zÃ©', meaning: 'æŒ‘é€‰æŸä¸€ä¸ªã€‚'},
            {char: 'åˆ¤æ–­', pinyin: 'pÃ n duÃ n', meaning: 'åšå‡ºå†³å®šæˆ–è¯„ä»·ã€‚'},
            {char: 'å»æ‰', pinyin: 'qÃ¹ diÃ o', meaning: 'ç§»é™¤æ‰ã€‚'},
            {char: 'è¯»ä¸€è¯»', pinyin: 'dÃº yÄ« dÃº', meaning: 'æœ—è¯»ä¸€ä¸‹ã€‚'},
            {char: 'å†™ä¸€å†™', pinyin: 'xiÄ› yÄ« xiÄ›', meaning: 'ä¹¦å†™ä¸€ä¸‹ã€‚'},
            {char: 'å¡«ä¸€å¡«', pinyin: 'tiÃ¡n yÄ« tiÃ¡n', meaning: 'å¡«å†™å†…å®¹ã€‚'},
            {char: 'ç®—ä¸€ç®—', pinyin: 'suÃ n yÄ« suÃ n', meaning: 'è®¡ç®—ä¸€ä¸‹ã€‚'},
            {char: 'æ¯”è¾ƒ', pinyin: 'bÇ jiÃ o', meaning: 'å¯¹æ¯”å·®å¼‚ã€‚'},
            {char: 'ç›¸æ¯”', pinyin: 'xiÄng bÇ', meaning: 'ç›¸äº’æ¯”è¾ƒã€‚'},
            {char: 'ç›´å°º', pinyin: 'zhÃ­ chÇ', meaning: 'æµ‹é‡é•¿åº¦çš„å·¥å…·ã€‚'},
            {char: 'ç»ƒä¹ ', pinyin: 'liÃ n xÃ­', meaning: 'åå¤åšä»¥ç†Ÿç»ƒã€‚'},
            {char: 'ç¬¬å‡ ', pinyin: 'dÃ¬ jÇ', meaning: 'è¯¢é—®é¡ºåºä½ç½®ã€‚'},
            {char: 'æ¥ç€', pinyin: 'jiÄ“ zhe', meaning: 'ç»§ç»­ä¸‹å»ã€‚'},
            {char: 'é è¿‘', pinyin: 'kÃ o jÃ¬n', meaning: 'æ¥è¿‘æŸç‰©ã€‚'},
            {char: 'é¡ºåº', pinyin: 'shÃ¹n xÃ¹', meaning: 'æ’åˆ—çš„æ¬¡åºã€‚'},
            {char: 'æ•°é‡', pinyin: 'shÃ¹ liÃ ng', meaning: 'äº‹ç‰©çš„å¤šå°‘ã€‚'},
            {char: 'è¯»ä½œ', pinyin: 'dÃº zuÃ²', meaning: 'æœ—è¯»çš„æ–¹å¼ã€‚'},
            {char: 'å›¾å½¢', pinyin: 'tÃº xÃ­ng', meaning: 'å½¢çŠ¶çš„å›¾æ¡ˆã€‚'},
            {char: 'ç»“æœ', pinyin: 'jiÃ© guÇ’', meaning: 'æœ€ç»ˆçš„ç»“å±€ã€‚'},
            {char: 'åˆ†ç±»', pinyin: 'fÄ“n lÃ¨i', meaning: 'åˆ†æˆç±»åˆ«ã€‚'},
            {char: 'ç¡®å®š', pinyin: 'quÃ¨ dÃ¬ng', meaning: 'ç¡®è®¤æ— è¯¯ã€‚'},
            {char: 'æ€æ ·', pinyin: 'zÄ›n yÃ ng', meaning: 'è¯¢é—®æ–¹å¼æˆ–æƒ…å†µã€‚'},
            {char: 'æ ‡å‡†', pinyin: 'biÄo zhÇ”n', meaning: 'è¡¡é‡çš„å‡†åˆ™ã€‚'},
            {char: 'é»„è‰²', pinyin: 'huÃ¡ng sÃ¨', meaning: 'ä¸€ç§é¢œè‰²ï¼Œå¦‚å¤ªé˜³ã€‚'},
            {char: 'çº¢è‰²', pinyin: 'hÃ³ng sÃ¨', meaning: 'ä¸€ç§é¢œè‰²ï¼Œå¦‚è‹¹æœã€‚'},
            {char: 'è§£ç­”', pinyin: 'jiÄ› dÃ¡', meaning: 'è§£é‡Šç­”æ¡ˆã€‚'},
            {char: 'å¯èƒ½', pinyin: 'kÄ› nÃ©ng', meaning: 'æœ‰å‘ç”Ÿçš„å‡ ç‡ã€‚'},
            {char: 'å¯¹åº”', pinyin: 'duÃ¬ yÃ¬ng', meaning: 'ç›¸äº’åŒ¹é…ã€‚'},
            {char: 'æ’åˆ—', pinyin: 'pÃ¡i liÃ¨', meaning: 'æŒ‰é¡ºåºæ‘†æ”¾ã€‚'},
            {char: 'ç®—å¼', pinyin: 'suÃ n shÃ¬', meaning: 'æ•°å­¦è¡¨è¾¾å¼ã€‚'},
            {char: 'ä»å°åˆ°å¤§', pinyin: 'cÃ³ng xiÇo dÃ o dÃ ', meaning: 'æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºã€‚'},
            {char: 'ä»å¤§åˆ°å°', pinyin: 'cÃ³ng dÃ  dÃ o xiÇo', meaning: 'æŒ‰ä»å¤§åˆ°å°çš„é¡ºåºã€‚'},
            {char: 'è§„å¾‹', pinyin: 'guÄ« lÇœ', meaning: 'é‡å¤çš„æ¨¡å¼ã€‚'}
        ];

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let correctAnswer = '';
        let errorCount = 0; // æ–°å¢ï¼šè®°å½•é”™è¯¯æ¬¡æ•°
        let synth = window.speechSynthesis;

        function speak(text) {
            if (synth.speaking) synth.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.7; // è°ƒæ•´ä¸ºæ›´æ…¢çš„é€Ÿåº¦ï¼Œä»¥æé«˜æ¸…æ™°åº¦
            utterance.pitch = 1.0; // é»˜è®¤éŸ³é«˜
            utterance.volume = 1.0; // æœ€å¤§éŸ³é‡
            synth.speak(utterance);
        }

        function getSpeakText(q) {
            const includeMeaning = document.getElementById('includeMeaning').checked;
            return includeMeaning ? `${q.char}ã€‚${q.meaning}` : `${q.char}ã€‚`;
        }

        function startGame() {
            currentQuestions = shuffleArray([...gameData]).slice(0, 8);
            currentQuestionIndex = 0;
            errorCount = 0; // é‡ç½®é”™è¯¯è®¡æ•°
            showQuestion();
        }

        function showQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                document.getElementById('successMessage').style.display = 'block';
                document.getElementById('errorCountDisplay').textContent = `ä½ é”™äº†${errorCount}é¢˜ï¼ˆæ€»å…±${currentQuestions.length}é¢˜ï¼‰`;
                return;
            }

            const q = currentQuestions[currentQuestionIndex];
            correctAnswer = q.char;
            
            document.getElementById('progress').textContent = 
                `ç¬¬${currentQuestionIndex + 1}é¢˜ / å…±${currentQuestions.length}é¢˜`;
            
            // ç”Ÿæˆé€‰é¡¹ï¼š1ä¸ªæ­£ç¡®ç­”æ¡ˆ + 3ä¸ªå¹²æ‰°é¡¹
            const options = [q.char];
            const otherChars = gameData.filter(item => item.char !== q.char).map(item => item.char);
            const shuffledOthers = shuffleArray(otherChars);
            options.push(...shuffledOthers.slice(0, 3));
            const shuffledOptions = shuffleArray(options);

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            shuffledOptions.forEach(char => {
                const btn = document.createElement('div');
                btn.className = 'option';
                btn.textContent = char;
                btn.onclick = () => checkAnswer(char, btn);
                optionsContainer.appendChild(btn);
            });

            // è‡ªåŠ¨æœ—è¯»é¢˜ç›®ï¼Œæ ¹æ®å¼€å…³å†³å®šæ˜¯å¦åŒ…æ‹¬å«ä¹‰
            speak(getSpeakText(q));
        }

        function checkAnswer(selectedChar, btnElement) {
            const options = document.querySelectorAll('.option');
            options.forEach(opt => opt.onclick = null); // ç¦ç”¨æ‰€æœ‰é€‰é¡¹
            
            if (selectedChar === correctAnswer) {
                btnElement.classList.add('correct');
                document.getElementById('correctSound').play();
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                }, 1000);
            } else {
                btnElement.classList.add('wrong');
                document.getElementById('wrongSound').play();
                errorCount++; // è®°å½•é”™è¯¯
                // é«˜äº®æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
                options.forEach(opt => {
                    if (opt.textContent === correctAnswer) {
                        opt.classList.add('correct');
                    }
                });
                setTimeout(() => {
                    currentQuestionIndex++;
                    showQuestion();
                }, 2000);
            }
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function restartGame() {
            document.getElementById('successMessage').style.display = 'none';
            startGame();
        }

        // åˆå§‹åŒ–
        document.getElementById('speakBtn').onclick = function() {
            if (currentQuestions[currentQuestionIndex]) {
                const q = currentQuestions[currentQuestionIndex];
                speak(getSpeakText(q)); // æ ¹æ®å¼€å…³å†³å®šæœ—è¯»å†…å®¹
            }
        };

        startGame();
    </script>
</body>
</html>